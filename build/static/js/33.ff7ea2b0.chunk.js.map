{"version":3,"sources":["features/Settings/components/SettingsParent.jsx"],"names":["SettingsParent","props","useState","parentData","setParentData","userId","useSelector","selectId_of_user","onShowSave","setOnShowSave","newParentProfile","setNewParentProfile","useForm","register","errors","formState","handleSubmit","showLoading","setShowLoading","showSuccessModal","setShowSuccessModal","showFailedModal","setShowFailedModal","useEffect","getData","a","GetParentProfile","data","handleChangeLink","linkArr","currentFbLink","linkmodel_set","find","item","name","currentInsLink","currentLinkedLink","facebook","url","push","instagram","linkedln","handleOnChangeProfile","e","type","console","log","target","value","getName","first_name","last_name","onSubmit","updateParentProfile","newParentInfo","birthday","id","response","newLink","length","updateLink","className","defaultValue","required","onChange","number_phone","minLength","telephone","province_code","district_code","ward_code","defaultLocation","province","ward","district","style","display","justifyContent","typeIcon","text","onAgree"],"mappings":"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","file":"static/js/33.ff7ea2b0.chunk.js","sourcesContent":["import { updateLink, updateParentProfile } from 'axios/profile';\nimport Loading from 'components/Loading/Loading';\nimport SettingsLocation from 'components/location/SettingsLocation';\nimport Modal from 'components/Modal/Modal';\nimport { selectId_of_user } from 'features/auth/authSlice';\nimport { GetParentProfile } from 'graphql/ProfileQueries';\nimport React, { Fragment, useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useSelector } from 'react-redux';\nimport LoadingField from './LoadingField';\nimport { getName } from './SettingsTutor';\n\nfunction SettingsParent(props) {\n\n    const [parentData, setParentData] = useState(null);\n    const userId = useSelector(selectId_of_user);\n    const [onShowSave, setOnShowSave] = useState(false);\n    const [newParentProfile, setNewParentProfile] = useState({});\n    const {register, formState: { errors }, handleSubmit} = useForm();\n    const [showLoading, setShowLoading] = useState(false);\n    const [showSuccessModal, setShowSuccessModal] = useState(false);\n    const [showFailedModal, setShowFailedModal] = useState(false);\n    \n    useEffect(()=> {\n        const getData = async () => {\n            const data = await GetParentProfile(userId);\n            setParentData(data);\n        }\n        getData();\n    }, [userId])\n    \n    const handleChangeLink = (data) => {\n        let linkArr = [];\n        const currentFbLink = parentData?.linkmodel_set?.find(item => item?.name === 'facebook');\n        const currentInsLink = parentData?.linkmodel_set?.find(item => item?.name === 'instagram');\n        const currentLinkedLink = parentData?.linkmodel_set?.find(item => item?.name === 'linkedln');\n        if(data.facebook !== currentFbLink?.url) {\n            linkArr.push({\n                ...currentFbLink,\n                url: data.facebook,\n            })\n        }\n\n        if(data.instagram !== currentInsLink?.url) {\n            linkArr.push({\n                ...currentInsLink,\n                url: data.instagram,\n            })\n        }\n\n        if(data.linkedln !== currentLinkedLink?.url) {\n            linkArr.push({\n                ...currentLinkedLink,\n                url: data.linkedln,\n            })\n        }\n        return linkArr;\n    }\n\n    const handleOnChangeProfile = (e, type) => {\n        console.log('kkk');\n        setOnShowSave(true);\n        const target = e.target.value;\n        if(type===\"name\") {\n            const {first_name, last_name} = getName(target);\n            setNewParentProfile({\n                ...newParentProfile,\n                \"first_name\": first_name,\n                \"last_name\": last_name,\n            })   \n        } else {\n            setNewParentProfile({\n                ...newParentProfile,\n                [type]: target,\n            })\n        }\n    }\n\n    const handleOnChangeLocation = ({province_code, district_code, ward_code}) => {\n        setOnShowSave(true);\n        setNewParentProfile({\n            ...newParentProfile,\n            province_code: province_code, \n            district_code: district_code,\n            ward_code: ward_code,\n        }) \n    }\n\n    const onSubmit = async (data) => {\n        setShowLoading(true);\n        let response = await updateParentProfile({\n            newParentInfo: {\n                birthday: data.birthday,\n                ...newParentProfile,\n            },\n            id: userId,\n        });\n\n        const newLink = await handleChangeLink(data);\n        if(newLink.length!==0) {\n            response = await updateLink({newLink: newLink});\n        }\n\n        setShowLoading(false);\n        if(response) {\n            setShowSuccessModal(true);\n        } else {\n            setShowFailedModal(true);\n        }\n    } \n\n    return (\n        <Fragment>\n        {parentData ? <form onSubmit={handleSubmit(onSubmit)} className=\"settings__parent\">\n            <div className=\"settings__field\">\n                <label>Họ và tên</label>\n                <input \n                    type=\"text\" \n                    defaultValue={`${parentData?.first_name} ${parentData?.last_name}`}\n                    {...register(\"name\", { required: true})}\n                    onChange={ e => handleOnChangeProfile(e, \"name\")}\n                />\n                {errors.name && \n                        <span className=\"settings__field__error\">Tên không hợp lệ</span>}\n            </div>\n            <div className=\"settings__field\">\n                <label>Số điện thoại</label>\n                <input type=\"number\" defaultValue={parentData?.number_phone}\n                    onChange={ e => handleOnChangeProfile(e, \"number_phone\")}\n                    {...register(\"telephone\", { required: true, minLength: 8})}\n                />\n                {errors.telephone && \n                        <span className=\"settings__field__error\">Số điện thoại không hợp lệ</span>}    \n            </div>\n            <div className=\"settings__field\">\n                <label>Ngày sinh</label>\n                <input type=\"date\" \n                    defaultValue={parentData?.birthday}\n                    {...register(\"birthday\")}\n                    onChange={ e => handleOnChangeProfile(e, \"birthday\")}\n                />\n            </div>\n            {/* <div className=\"settings__field\">\n                <label>Ảnh đại diện</label>\n                <input type=\"file\" />\n            </div> */}\n            <SettingsLocation onChange={handleOnChangeLocation} defaultLocation={{province: parentData?.province_code, ward: parentData?.ward_code, district: parentData?.district_code}}/>\n            <div className=\"settings__field\">\n                <label>Link Facebook</label>\n                <input \n                    type=\"text\"\n                    defaultValue={parentData?.linkmodel_set?.find(item => item?.name === 'facebook')?.url || \"\"}\n                    {...register(\"facebook\")}\n                    onChange={(e) => setOnShowSave(true)}\n                />\n            </div>\n            <div className=\"settings__field\">\n                <label>Link Instagram</label>\n                <input \n                    type=\"text\"\n                    defaultValue={parentData?.linkmodel_set?.find(item => item?.name === 'instagram')?.url || \"\"}\n                    {...register(\"instagram\")}\n                    onChange={(e) => setOnShowSave(true)}\n                />\n            </div>\n            <div className=\"settings__field\">\n                <label>Link Linkedin</label>\n                <input \n                    type=\"text\"\n                    defaultValue={parentData?.linkmodel_set?.find(item => item?.name === 'linkedln')?.url || \"\"}\n                    {...register(\"linkedln\")}\n                    onChange={(e) => setOnShowSave(true)}\n                />\n            </div>\n            {onShowSave && <div style={{display: 'flex', justifyContent: 'center'}}>\n                <button type=\"submit\" className=\"settings__save\">Lưu</button>\n            </div>}\n        </form> : <LoadingField />}\n        {showLoading && <Loading />}\n        {showSuccessModal && <Modal typeIcon=\"check\" text=\"Thay đổi thông tin thành công\" onAgree={() => setShowSuccessModal(false)}/>}\n        {showFailedModal && <Modal typeIcon=\"fail\" text=\"Thay đổi thông tin thất bại\" onAgree={() => setShowFailedModal(false)}/>}\n        </Fragment>\n    );\n}\n\nexport default SettingsParent;"],"sourceRoot":""}